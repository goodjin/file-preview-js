# 设计文档

## 概述

本设计文档描述如何修改智能体系统的提示词配置，使所有智能体在遇到编程任务时默认使用 JavaScript 而非 Python。修改涉及四个提示词配置文件：`base.txt`、`root.txt`、`tool_rules.txt` 和 `workspace.txt`。

## 架构

本功能不涉及架构变更，仅修改现有的提示词配置文件内容。

```
config/prompts/
├── base.txt          # 基础提示词 - 添加默认 JavaScript 语言指导
├── root.txt          # 根智能体提示词 - 更新技术约束默认值
├── tool_rules.txt    # 工具规则提示词 - 确保示例一致性
└── workspace.txt     # 工作空间提示词 - 更新命令示例
```

## 组件和接口

### 1. 基础提示词修改 (base.txt)

**修改位置**: `[超出模型能力的处理]` 部分

**当前内容**:
```
- 如果需要与外部世界交互，尽可能使用chrome或者JavaScript工具。
- 如果需要处理结构化数据，并且你知道哪些基于web的JavaScript库可以处理，尽可能使用chrome工具，在网页里处理。
```

**修改方案**: 在该部分添加明确的默认编程语言声明：

```
【默认编程语言（重要）】
当需要编程解决问题时，除非用户明确指定其他语言，否则必须使用 JavaScript 作为默认编程语言。
- 优先使用 JavaScript/Node.js 而非 Python
- 前端任务使用 HTML + JavaScript
- 后端/脚本任务使用 Node.js
- 数据处理任务优先考虑 JavaScript 库
```

### 2. 根智能体提示词修改 (root.txt)

**修改位置**: `【技术约束传递原则（重要）】` 部分

**当前内容**:
```
- 如果要编程，且用户没有明确要求，默认使用HTML、JS在前端实现。
```

**修改方案**: 更新为更明确的表述：

```
- 如果要编程，且用户没有明确要求编程语言，默认使用 JavaScript：
  - 前端任务：使用 HTML + JavaScript
  - 后端/脚本任务：使用 Node.js
  - 禁止默认使用 Python，除非用户明确要求
```

### 3. 工具规则提示词修改 (tool_rules.txt)

**修改位置**: 示例代码部分

**当前状态**: 示例代码已使用 JavaScript 语法，无需修改

### 4. 工作空间提示词修改 (workspace.txt)

**修改位置**: `## 可用工具` 和 `### 协作示例` 部分

**当前状态**: 示例代码已使用 JavaScript 语法，但命令执行示例可以更明确

**修改方案**: 在 `run_command` 示例中添加 Node.js 示例：

```
### run_command - 执行命令
```
run_command({ command: "node main.js", timeoutMs: 30000 })
run_command({ command: "npm install", timeoutMs: 60000 })
run_command({ command: "npm test", timeoutMs: 30000 })
```
```

## 数据模型

本功能不涉及数据模型变更，仅修改文本配置文件。

## 正确性属性

*正确性属性是指在系统所有有效执行中都应保持为真的特征或行为——本质上是关于系统应该做什么的形式化声明。属性作为人类可读规范和机器可验证正确性保证之间的桥梁。*

由于本功能仅涉及提示词文本内容的修改，所有验收标准都是基于示例的验证（检查文件内容是否包含特定文本），而非基于属性的测试。因此，本设计不包含可执行的正确性属性。

**验证方式**: 通过人工审查或简单的文本搜索验证提示词文件是否包含：
1. 明确的 JavaScript 默认语言声明
2. JavaScript 优先于 Python 的说明
3. 一致的 JavaScript 代码示例

## 错误处理

本功能不涉及运行时错误处理，仅为配置文件修改。

## 测试策略

### 单元测试

由于本功能仅涉及提示词文本修改，不需要传统的单元测试。

### 验证方法

1. **文本内容验证**: 检查修改后的提示词文件是否包含预期的 JavaScript 默认语言声明
2. **一致性检查**: 确保所有提示词文件中的编程语言相关内容保持一致
3. **人工审查**: 审查修改后的提示词是否清晰、无歧义

### 集成测试

可选：创建一个测试场景，向智能体发送编程任务（不指定语言），验证智能体是否选择 JavaScript。
