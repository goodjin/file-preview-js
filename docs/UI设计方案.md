# 文件预览系统 - UI/UX设计方案

## 1. 设计概述

### 1.1 设计目标

基于PRD文档的需求，为45种文件格式提供统一、流畅、易用的预览体验，隐藏复杂技术细节，让用户可以快速、直观地查看各种文件内容。

### 1.2 设计理念

- **统一体验**：45种文件格式使用统一的界面框架，降低学习成本
- **渐进展示**：根据文件类型动态显示相关功能，避免界面混乱
- **流畅交互**：提供快速的文件类型检测和流畅的预览体验
- **容错友好**：清晰的错误提示和恢复方案

### 1.3 适用场景

- **开发人员**：快速查看代码、配置文件、文档
- **运维人员**：查看日志文件、配置文档
- **运营管理**：预览报表、计划文档
- **最终用户**：日常文档、图片、音视频预览

---

## 2. 整体界面架构

### 2.1 页面结构设计

#### 2.1.1 桌面端布局（1200px+）

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  文件名.xlsx  |  [全屏] [下载] [打印] [关闭]                │  顶部导航栏 (60px)
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│                                                                     │
│                         主预览区域                                  │
│                    (自适应内容，居中显示)                           │
│                                                                     │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [-] 缩放 100% [+]  |  [上一页] 第 5/20 页 [下一页]  |  [辅助功能]  │  底部工具栏 (56px)
└─────────────────────────────────────────────────────────────────────┘
```

**设计要点：**
- 顶部导航栏：固定高度60px，包含Logo、文件信息、全局操作
- 主预览区域：自适应剩余空间，内容居中显示
- 底部工具栏：固定高度56px，提供预览控制和辅助功能

#### 2.1.2 移动端布局（320px-767px）

```
┌────────────────────────────────────┐
│  Logo  文件名.xlsx [≡]             │  顶部导航栏 (56px)
├────────────────────────────────────┤
│                                    │
│                                    │
│         主预览区域                 │
│     (手势操作：缩放、翻页)         │
│                                    │
│                                    │
├────────────────────────────────────┤
│  [-] 100% [+]    5/20  [上一页] [下一页]  │  底部工具栏 (64px)
└────────────────────────────────────┘
```

**设计要点：**
- 紧凑型设计，减少垂直空间占用
- 操作按钮适配触摸（最小44px × 44px）
- 支持横屏/竖屏自适应

---

## 3. 核心页面设计

### 3.1 文件选择与上传界面

#### 3.1.1 入口页面（文件选择）

**场景描述：** 用户首次进入系统或点击"打开新文件"时显示

**界面设计：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  文件预览系统                                                         │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│                      ┌─────────────────┐                           │
│                      │                 │                           │
│                      │   点击或拖拽    │                           │
│                      │   上传文件      │                           │
│                      │                 │                           │
│                      └─────────────────┘                           │
│                                                                     │
│  支持格式：Office文档、PDF、图片、音视频、压缩包等45种格式            │
│                                                                     │
│  最近文件：                                                          │
│  ┌───────────────────────────────────────────────────────────┐     │
│  │ 📄 报表.xlsx       2.3MB    2024-01-15                  │     │
│  │ 📑 产品文档.pdf     5.1MB    2024-01-14                  │     │
│  │ 🖼️ 宣传图.png       1.8MB    2024-01-13                  │     │
│  └───────────────────────────────────────────────────────────┘     │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**交互设计：**
1. 支持点击上传区域打开文件选择对话框
2. 支持拖拽文件到上传区域
3. 支持最近文件快速打开
4. 显示支持的文件格式说明

**组件使用：**
- `FileUpload`：文件上传组件
- `Button`：上传按钮
- `FileList`：最近文件列表

### 3.2 文件预览主界面

#### 3.2.1 加载状态设计

**大文件加载（>10MB）：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  项目计划.pptx (28.5MB)          [全屏] [下载] [关闭]     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│                       ┌─────────────────┐                          │
│                       │                 │                          │
│                       │   🔄 加载中...  │                          │
│                       │                 │                          │
│                       └─────────────────┘                          │
│                                                                     │
│                   ████████████░░░░░░░░░░  65%                      │
│                   18.5MB / 28.5MB                                 │
│                                                                     │
│  💡 文件较大，正在加载中，请稍候...                                  │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**小文件加载（<10MB）：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  说明文档.pdf (1.2MB)             [全屏] [下载] [关闭]     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│                       ┌─────────────────┐                          │
│                       │                 │                          │
│                       │   🔄 加载中...  │                          │
│                       │                 │                          │
│                       └─────────────────┘                          │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**组件使用：**
- `Spinner`：加载动画
- `ProgressBar`：进度条（仅大文件显示）
- `Alert`：提示信息

#### 3.2.2 Office文档预览界面

**Excel预览：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  销售报表.xlsx (2.3MB)           [全屏] [下载] [打印]     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │   A   │   B   │   C   │   D   │   E   │   F   │   G   │   │   │
│  ├────────┼────────┼────────┼────────┼────────┼────────┼────────┤   │
│  │  产品 │  Q1销量│  Q2销量│  Q3销量│  Q4销量│  合计  │  增长率│   │   │
│  ├────────┼────────┼────────┼────────┼────────┼────────┼────────┤   │
│  │ 产品A │ 12500  │ 13800  │ 15200  │ 16800  │ 58300  │ +34.4%│   │   │
│  │ 产品B │ 8200   │ 9100   │ 10200  │ 11500  │ 39000  │ +40.2%│   │   │
│  │ 产品C │ 15600  │ 17200  │ 19100  │ 21000  │ 72900  │ +34.6%│   │   │
│  │ ...   │ ...    │ ...    │ ...    │ ...    │ ...    │ ...   │   │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [-] 缩放 100% [+]  |  [Sheet1] [Sheet2] [Sheet3]  |  [导出]       │
└─────────────────────────────────────────────────────────────────────┘
```

**设计要点：**
- 表格内容可滚动
- 支持工作表切换
- 行列标头固定，内容滚动
- 数据对齐：文本左对齐，数字右对齐

**组件使用：**
- `PreviewContainer`：预览容器
- `Toolbar`：工具栏
- `ExcelPreviewer`：Excel专用预览器

**Word预览：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  产品需求文档.docx (5.8MB)         [全屏] [下载] [打印]     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │  1. 项目背景                                                │   │
│  │                                                             │   │
│  │    随着企业数字化转型的加速，传统的纸质文档管理方式已经无法   │   │
│  │  满足现代办公的需求。本项目旨在开发一个纯前端的文件预览系   │   │
│  │  统，支持多种文件格式的在线预览，提高办公效率。              │   │
│  │                                                             │   │
│  │  2. 产品目标                                                │   │
│  │                                                             │   │
│  │    开发一个全面的纯前端文件预览系统，支持45种文件格式的在线 │   │
│  │  预览，无需依赖服务端解析。                                 │   │
│  │                                                             │   │
│  │                                                             │   │
│  │                    [    第 1 / 5 页    ]                     │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [-] 缩放 100% [+]  |  [上一页] 第 1/5 页 [下一页]  |  [目录] [打印] │
└─────────────────────────────────────────────────────────────────────┘
```

**PowerPoint预览：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  项目汇报.pptx (12.3MB)           [全屏] [下载] [打印]     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│                       ┌─────────────────┐                          │
│                       │                 │                          │
│                       │   第 1 / 15 页  │                          │
│                       │                 │                          │
│                       │   [幻灯片内容]  │                          │
│                       │                 │                          │
│                       └─────────────────┘                          │
│  ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐ ┌───┐      │
│  │ 1 │ │ 2 │ │ 3 │ │ 4 │ │ 5 │ │ 6 │ │ 7 │ │ 8 │ │ 9 │ │10 │ ... │
│  └───┘ └───┘ └───┘ └───┘ └───┘ └───┘ └───┘ └───┘ └───┘ └───┘      │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [-] 缩放 100% [+]  |  [上一页] 第 1/15 页 [下一页]  |  [幻灯片放映]│
└─────────────────────────────────────────────────────────────────────┘
```

#### 3.2.3 PDF文档预览界面

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  用户手册.pdf (8.5MB)             [全屏] [下载] [打印]     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                                                             │   │
│  │                    [PDF文档内容区域]                         │   │
│  │                                                             │   │
│  │                                                             │   │
│  │                                                             │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [-] 缩放 100% [+]  |  [上一页] 第 1/50 页 [下一页]  |  [目录] [搜索]│
└─────────────────────────────────────────────────────────────────────┘
```

**设计要点：**
- 支持单页/双页模式切换
- 支持目录导航
- 支持关键词搜索高亮
- 支持缩放和旋转

#### 3.2.4 图片预览界面

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  产品宣传图.png (5.2MB)           [全屏] [下载] [打印]     │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│                        ┌──────────────┐                            │
│                        │              │                            │
│                        │   [图片内容]  │                            │
│                        │              │                            │
│                        └──────────────┘                            │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [-] 缩放 100% [+]  |  [逆时针] [顺时针]  |  [旋转] [对比] [信息]  │
└─────────────────────────────────────────────────────────────────────┘
```

**设计要点：**
- 支持缩放（双指缩放、按钮缩放）
- 支持旋转（90度步进）
- 支持左右拖动查看大图
- 显示图片尺寸、大小等元数据

#### 3.2.5 音视频预览界面

**音频预览（mp3, wav）：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  背景音乐.mp3 (8.5MB)             [全屏] [下载]             │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│                        ┌─────────────────┐                          │
│                        │                 │                          │
│                        │  🎵 音频波形图   │                          │
│                        │                 │                          │
│                        └─────────────────┘                          │
│                        歌曲：星空                                   │
│                        时长：03:45 / 05:20                           │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [⏮]  [⏪]  [▶]  [⏩]  [⏭]  |  🔊  音量 100%  |  [循环] [列表]    │
└─────────────────────────────────────────────────────────────────────┘
```

**视频预览（mp4, webm）：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  产品演示.mp4 (128.5MB)           [全屏] [下载] [画中画]   │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│                        ┌─────────────────────┐                      │
│                        │                     │                      │
│                        │   [视频播放画面]     │                      │
│                        │                     │                      │
│                        └─────────────────────┘                      │
│                        ▶  01:23 / 05:40  │  ═════════╩════════════│
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [⏮]  [⏪]  [▶]  [⏩]  [⏭]  |  🔊  音量 80%  |  [全屏] [倍速] [画质]│
└─────────────────────────────────────────────────────────────────────┘
```

**设计要点：**
- 视频自适应容器大小
- 支持倍速播放（0.5x, 1x, 1.5x, 2x）
- 支持画质切换（如有多画质）
- 支持画中画模式

#### 3.2.6 压缩包预览界面

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  项目文件.zip (45.6MB)            [全屏] [下载]             │
├─────────────────────────────────────────────────────────────────────┤
│  名称            │ 大小      │ 修改时间        │ 操作                │
├─────────────────────────────────────────────────────────────────────┤
│  📁 src/         │ -         │ 2024-01-15     │ [打开]              │
│  📁 docs/        │ -         │ 2024-01-14     │ [打开]              │
│  📁 assets/      │ -         │ 2024-01-13     │ [打开]              │
│  📄 index.html   │ 12.5KB    │ 2024-01-15     │ [预览] [下载]       │
│  📄 app.js       │ 45.2KB    │ 2024-01-15     │ [预览] [下载]       │
│  📄 style.css    │ 8.3KB     │ 2024-01-15     │ [预览] [下载]       │
│  📄 README.md    │ 3.2KB     │ 2024-01-10     │ [预览] [下载]       │
│  📄 package.json │ 1.1KB     │ 2024-01-10     │ [预览] [下载]       │
├─────────────────────────────────────────────────────────────────────┤
│  [返回上级]  │  文件夹：3  文件：5  总大小：45.6MB                  │
└─────────────────────────────────────────────────────────────────────┘
```

**设计要点：**
- 文件列表视图，支持文件夹导航
- 支持文件预览和下载
- 显示文件元数据
- 支持文件类型过滤

#### 3.2.7 文本文件预览界面（txt, md, xml, json）

**Markdown预览：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  README.md (8.3KB)               [全屏] [下载] [编辑]      │
├─────────────────────────────────────────────────────────────────────┤
│  [原文] [预览]                                                       │
├─────────────────────────────────────────────────────────────────────┤
│  # 文件预览系统                                                     │
│                                                                     │
│  一个纯前端的文件预览系统，支持45种文件格式。                        │
│                                                                     │
│  ## 功能特性                                                        │
│                                                                     │
│  - 支持多种文件格式                                                 │
│  - 纯前端实现                                                       │
│  - 流畅的预览体验                                                   │
│                                                                     │
│  ## 快速开始                                                        │
│                                                                     │
│  ```bash                                                            │
│  npm install                                                       │
│  npm start                                                          │
│  ```                                                                │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**JSON预览（带语法高亮）：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  config.json (2.1KB)              [全屏] [下载] [格式化]  │
├─────────────────────────────────────────────────────────────────────┤
│  {                                                                  │
│    "name": "file-preview-system",                                   │
│    "version": "1.0.0",                                              │
│    "description": "纯前端文件预览系统",                              │
│    "supportedFormats": [                                            │
│      "pdf",                                                         │
│      "docx",                                                        │
│      "xlsx",                                                        │
│      "pptx",                                                        │
│      ...                                                            │
│    ],                                                               │
│    "settings": {                                                    │
│      "maxFileSize": 104857600,                                      │
│      "defaultZoom": 1.0,                                            │
│      "enableFullscreen": true                                        │
│    }                                                                │
│  }                                                                  │
└─────────────────────────────────────────────────────────────────────┘
```

#### 3.2.8 特殊格式预览界面（xmind, bpmn, drawio）

**思维导图预览：**

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  产品规划.xmind (1.2MB)           [全屏] [下载] [导出]    │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│                        ┌──────────────┐                            │
│                        │  产品规划    │                            │
│                        └──────────────┘                            │
│                            │                                       │
│           ┌────────────────┼────────────────┐                     │
│           ▼                ▼                ▼                     │
│      ┌──────────┐   ┌──────────┐   ┌──────────┐                  │
│      │ 市场分析  │   │ 产品设计  │   │ 技术实现  │                  │
│      └──────────┘   └──────────┘   └──────────┘                  │
│                                                                     │
├─────────────────────────────────────────────────────────────────────┤
│  [-] 缩放 100% [+]  |  [折叠全部] [展开全部]  |  [导出图片]       │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 4. 交互流程设计

### 4.1 主要交互流程

#### 4.1.1 文件预览流程

```
[用户选择文件]
      │
      ▼
[文件类型检测] ──> [不支持格式] ──> [错误提示："此格式暂不支持预览"]
      │
      ▼
[加载文件]
      │
      ├─ 小文件 (<10MB) ──> [显示加载动画] ──> [预览内容]
      │
      └─ 大文件 (≥10MB) ──> [显示加载进度条] ──> [预览内容]
            │
            └─ 加载失败 ──> [错误提示："文件加载失败，请重试"]
```

#### 4.1.2 缩放控制流程

```
[用户点击缩放按钮]
      │
      ├─ [放大] ──> [计算新的缩放比例] ──> [更新预览容器transform]
      │
      └─ [缩小] ──> [计算新的缩放比例] ──> [更新预览容器transform]
            │
            ├─ 达到最小缩放 ──> [禁用缩小按钮]
            │
            └─ 达到最大缩放 ──> [禁用放大按钮]
```

#### 4.1.3 翻页控制流程（文档类）

```
[用户点击翻页按钮]
      │
      ├─ [上一页] ──> [当前页 > 1] ──> [当前页 - 1] ──> [更新显示]
      │                    │
      │                    └─ [当前页 = 1] ──> [禁用上一页按钮]
      │
      └─ [下一页] ──> [当前页 < 总页数] ──> [当前页 + 1] ──> [更新显示]
                           │
                           └─ [当前页 = 总页数] ──> [禁用下一页按钮]
```

### 4.2 手势交互（移动端）

#### 4.2.1 双指缩放

```
[用户双指按住屏幕]
      │
      ▼
[记录初始双指距离]
      │
      ▼
[双指移动中] ──> [计算当前双指距离] ──> [计算缩放比例] ──> [更新预览]
      │
      ▼
[双指松开] ──> [结束缩放，保持在当前位置]
```

#### 4.2.2 单指滑动翻页

```
[用户单指按住屏幕]
      │
      ▼
[记录初始触摸位置]
      │
      ▼
[手指滑动中] ──> [计算滑动方向和距离] ──> [预览翻页效果]
      │
      ├─ 向左滑动 ──> [上一页]
      │
      └─ 向右滑动 ──> [下一页]
            │
            ▼
[手指松开] ──> [执行翻页或取消翻页]
```

---

## 5. 状态与反馈设计

### 5.1 加载状态

#### 5.1.1 小文件加载（<10MB）

```
┌─────────────────────────────────────┐
│                                     │
│           🔄 加载中...              │
│                                     │
└─────────────────────────────────────┘
```

**特征：**
- 显示旋转动画
- 无进度条
- 加载时间 < 3秒

#### 5.1.2 大文件加载（≥10MB）

```
┌─────────────────────────────────────┐
│                                     │
│           🔄 加载中...              │
│                                     │
│     ████████░░░░░░░░░  45%          │
│     12.5MB / 28.0MB                 │
│                                     │
│  💡 文件较大，正在加载中...         │
└─────────────────────────────────────┘
```

**特征：**
- 显示旋转动画
- 显示进度条
- 显示已加载/总大小
- 显示百分比
- 加载时间 > 3秒时显示提示

### 5.2 错误状态

#### 5.2.1 文件不支持

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│                        ⚠️                                           │
│                                                                     │
│                   此格式暂不支持预览                                 │
│                                                                     │
│              当前文件：unknown.xyz (2.5MB)                          │
│                                                                     │
│           系统支持的格式：Office文档、PDF、图片、音视频等           │
│                                                                     │
│                        [下载文件] [关闭]                             │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 5.2.2 文件加载失败

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│                        ✕                                           │
│                                                                     │
│                   文件加载失败，请重试                               │
│                                                                     │
│              错误原因：网络连接中断                                  │
│                                                                     │
│                        [重新加载] [下载文件] [关闭]                 │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 5.2.3 文件过大

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│                        ⚠️                                           │
│                                                                     │
│                   文件过大，无法预览                                 │
│                                                                     │
│              当前文件：large_file.zip (256.5MB)                     │
│              支持的最大文件大小：100MB                               │
│                                                                     │
│                        [下载文件] [关闭]                             │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 5.2.4 文件损坏

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│                        ✕                                           │
│                                                                     │
│                   文件损坏，无法打开                                 │
│                                                                     │
│              错误原因：文件格式错误或文件损坏                        │
│                                                                     │
│                        [重新选择] [关闭]                             │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### 5.3 空状态

#### 5.3.1 无最近文件

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│                        📂                                           │
│                                                                     │
│                     暂无最近文件                                     │
│                                                                     │
│              上传或选择一个文件开始预览                               │
│                                                                     │
│                        [选择文件] [上传文件]                        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 6. 响应式设计方案

### 6.1 断点定义

| 断点 | 屏幕宽度 | 设备类型 | 设计特点 |
|------|---------|---------|---------|
| xs   | 320px   | 小屏手机 | 单列布局，精简功能 |
| sm   | 480px   | 大屏手机 | 单列布局，增加显示内容 |
| md   | 768px   | 平板竖屏 | 单列布局，部分功能展开 |
| lg   | 1024px  | 平板横屏/小笔记本 | 接近桌面布局 |
| xl   | 1200px  | 标准桌面 | 完整桌面布局 |
| 2xl  | 1440px  | 大屏显示器 | 优化大屏显示 |

### 6.2 布局响应策略

#### 6.2.1 顶部导航栏响应式

**桌面端（≥1024px）：**
```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  文件名.xlsx (1.2MB)        [全屏] [下载] [打印] [关闭]       │
└─────────────────────────────────────────────────────────────────────┘
```

**平板（768px-1023px）：**
```
┌────────────────────────────────────────────────────────┐
│  Logo  文件名.xlsx (1.2MB)        [全屏] [≡]             │
└────────────────────────────────────────────────────────┘
```

**移动端（<768px）：**
```
┌────────────────────────────────────┐
│  Logo  文件名.xlsx [≡]             │
└────────────────────────────────────┘
```

**响应式规则：**
- 文件名截断：桌面端显示完整，移动端显示前20字符
- 操作按钮折叠：移动端折叠到菜单（≡）
- 高度调整：桌面60px，平板56px，移动端56px/48px(横屏)

#### 6.2.2 底部工具栏响应式

**桌面端（≥1024px）：**
```
┌─────────────────────────────────────────────────────────────────────┐
│  [-] 缩放 100% [+]    [上一页] 第 5/20 页 [下一页]     [辅助功能]   │
└─────────────────────────────────────────────────────────────────────┘
```

**平板（768px-1023px）：**
```
┌────────────────────────────────────────────────────┐
│  [-] 100% [+]    [上一页] 5/20 [下一页]              │
└────────────────────────────────────────────────────┘
```

**移动端（<768px）：**
```
┌────────────────────────────────────┐
│  [-] 100% [+]    5/20              │
│  [上一页] [下一页]                  │
└────────────────────────────────────┘
```

**响应式规则：**
- 按钮尺寸：桌面36px，移动端44px（满足触摸要求）
- 功能精简：移动端只保留核心功能
- 布局调整：移动端分两行显示

### 6.3 触摸优化

#### 6.3.1 触摸目标尺寸

| 元素类型 | 桌面端尺寸 | 移动端尺寸 | 说明 |
|---------|----------|----------|------|
| 按钮 | 36px × 36px | 44px × 44px | 满足最小触摸区域 |
| 图标按钮 | 32px × 32px | 40px × 40px | 包含可点击区域 |
| 列表项 | 高度32px | 高度48px | 增加可点击区域 |
| 输入框 | 高度40px | 高度48px | 便于触摸输入 |

#### 6.3.2 手势支持

| 手势 | 功能 | 适用场景 |
|------|------|---------|
| 单击 | 激活/选择 | 按钮、链接、列表项 |
| 双击 | 放大/缩小 | 图片预览 |
| 长按 | 显示菜单 | 文件列表、压缩包 |
| 双指捏合 | 缩放 | 图片、PDF、文档 |
| 单指滑动 | 翻页/滚动 | 文档、PDF、长列表 |
| 双指拖动 | 移动 | 大图、PDF |

---

## 7. 特殊场景设计

### 7.1 大文件预览优化

#### 7.1.1 分块加载策略

```
文件加载阶段：
1. 快速检测文件类型（<100ms）
2. 加载文件元数据（文件头）
3. 显示文件基本信息
4. 分块加载文件内容
5. 优先显示首屏内容
6. 后台加载剩余内容
```

**进度显示：**
```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  大文件.pdf (85.6MB)          [全屏] [下载] [打印]         │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│                        ┌─────────────────┐                          │
│                        │   🔄 加载中...  │                          │
│                        └─────────────────┘                          │
│                                                                     │
│                   ████████░░░░░░░░░  35%                             │
│                   30.0MB / 85.6MB  预计剩余: 15秒                   │
│                                                                     │
│  💡 文件较大，正在优先加载第一页，您可以先浏览其他内容              │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 7.1.2 分页预览策略

对于大文档（PDF、Word等）：
- 优先加载当前页
- 预加载相邻页面（上一页、下一页）
- 懒加载远端页面
- 支持按需加载

### 7.2 错误恢复

#### 7.2.1 网络错误恢复

```
[网络中断]
      │
      ▼
[显示错误提示："网络连接中断"]
      │
      ├─ [自动重试] ──> 3秒后自动重试
      │
      ├─ [手动重试] ──> 用户点击"重新加载"
      │
      └─ [下载文件] ──> 提供文件下载
```

#### 7.2.2 文件损坏处理

```
[文件解析失败]
      │
      ▼
[显示错误提示："文件可能损坏"]
      │
      ├─ [重新选择] ──> 允许用户重新选择文件
      │
      ├─ [尝试其他格式] ──> 尝试使用兼容格式
      │
      └─ [下载文件] ──> 提供文件下载
```

### 7.3 多文件预览

#### 7.3.1 文件列表模式

```
┌─────────────────────────────────────────────────────────────────────┐
│  Logo  |  文件预览 (5个文件)                 [全屏] [批量下载]     │
├─────────────────────────────────────────────────────────────────────┤
│  [全部] [文档] [图片] [音视频] [其他]                                 │
├─────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │ 📄 报表.xlsx     2.3MB    [预览] [下载]                      │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │ 📑 产品文档.pdf   5.1MB    [预览] [下载]                      │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │ 🖼️ 宣传图.png     1.8MB    [预览] [下载]                      │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │ 🎵 背景音乐.mp3   8.5MB    [预览] [下载]                      │   │
│  ├─────────────────────────────────────────────────────────────┤   │
│  │ 🎥 产品演示.mp4   128.5MB  [预览] [下载]                      │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

#### 7.3.2 快速切换预览

在文件列表中点击"预览"后，返回按钮旁边显示"上一个/下一个"：
```
┌─────────────────────────────────────────────────────────────────────┐
│  [<] 返回  [上一个] [下一个]                                        │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 8. 无障碍设计

### 8.1 键盘导航

| 按键 | 功能 | 说明 |
|------|------|------|
| Tab | 焦点切换 | 在可交互元素间切换焦点 |
| Shift+Tab | 反向焦点切换 | 反向切换焦点 |
| Enter / Space | 激活 | 激活当前焦点元素 |
| Esc | 关闭/返回 | 关闭弹窗、退出全屏 |
| ↑ / ↓ | 上下导航 | 在列表中上下移动 |
| ← / → | 左右导航 | 翻页、切换标签 |
| + / - | 缩放 | 放大/缩小预览 |
| Home | 首页 | 跳转到首页 |
| End | 尾页 | 跳转到尾页 |

### 8.2 ARIA标签

```html
<!-- 按钮 -->
<button aria-label="放大预览" aria-controls="preview-content">
  <Icon name="zoom-in" />
</button>

<!-- 进度条 -->
<div role="progressbar" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100" aria-label="文件加载进度">
  65%
</div>

<!-- 图片预览区域 -->
<div id="preview-content" role="img" aria-label="预览内容区域">
  <img src="..." alt="产品宣传图" />
</div>

<!-- 页面导航 -->
<div role="navigation" aria-label="页面导航">
  <button aria-label="上一页" aria-controls="preview-content">上一页</button>
  <span aria-live="polite" aria-atomic="true">第 5 / 20 页</span>
  <button aria-label="下一页" aria-controls="preview-content">下一页</button>
</div>
```

### 8.3 焦点管理

```javascript
// 弹窗打开时，焦点自动进入弹窗
function openModal(modalElement) {
  modalElement.style.display = 'block';
  const focusableElements = modalElement.querySelectorAll('button, input, select, a');
  focusableElements[0]?.focus();
}

// 弹窗关闭时，焦点返回触发元素
function closeModal(modalElement, triggerElement) {
  modalElement.style.display = 'none';
  triggerElement?.focus();
}

// 焦点陷阱（在弹窗内部）
function trapFocus(event, modalElement) {
  const focusableElements = modalElement.querySelectorAll('button, input, select, a');
  const firstElement = focusableElements[0];
  const lastElement = focusableElements[focusableElements.length - 1];

  if (event.key === 'Tab') {
    if (event.shiftKey && document.activeElement === firstElement) {
      event.preventDefault();
      lastElement.focus();
    } else if (!event.shiftKey && document.activeElement === lastElement) {
      event.preventDefault();
      firstElement.focus();
    }
  }
}
```

---

## 9. 性能优化设计

### 9.1 视觉性能优化

#### 9.1.1 图片优化

- **懒加载**：滚动到可视区域才加载
- **缩略图**：优先加载低分辨率版本
- **WebP格式**：优先使用WebP格式
- **自适应质量**：根据设备屏幕调整

```javascript
// 图片懒加载示例
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      const img = entry.target;
      img.src = img.dataset.src;
      observer.unobserve(img);
    }
  });
});

document.querySelectorAll('img[data-src]').forEach(img => {
  observer.observe(img);
});
```

#### 9.1.2 CSS优化

- 使用CSS变量管理主题
- 使用CSS渐变替代图片背景
- SVG图标优先于PNG
- 压缩和合并CSS文件

```css
/* CSS变量定义 */
:root {
  --primary-color: #3B82F6;
  --text-primary: #1F2937;
  --text-secondary: #6B7280;
  --border-color: #E5E7EB;
  --spacing-md: 16px;
}

/* 渐变背景 */
.background-gradient {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
```

### 9.2 交互性能优化

#### 9.2.1 防抖与节流

```javascript
// 搜索输入防抖（300ms）
const debouncedSearch = debounce((keyword) => {
  // 执行搜索
}, 300);

// 缩放节流（100ms）
const throttledZoom = throttle((scale) => {
  // 执行缩放
}, 100);
```

#### 9.2.2 虚拟滚动

对于长列表（如压缩包文件列表）使用虚拟滚动：

```javascript
import { FixedSizeList } from 'react-window';

const FileList = ({ files }) => (
  <FixedSizeList
    height={600}
    itemCount={files.length}
    itemSize={80}
    width="100%"
  >
    {({ index, style }) => (
      <div style={style}>
        <FileItem file={files[index]} />
      </div>
    )}
  </FixedSizeList>
);
```

### 9.3 加载性能优化

#### 9.3.1 代码分割

```javascript
// 懒加载预览器组件
const ExcelPreviewer = React.lazy(() => import('./previewers/ExcelPreviewer'));
const PDFPreviewer = React.lazy(() => import('./previewers/PDFPreviewer'));

function PreviewContainer({ fileType }) {
  const Previewer = getPreviewerComponent(fileType);
  return (
    <React.Suspense fallback={<Spinner />}>
      <Previewer />
    </React.Suspense>
  );
}
```

#### 9.3.2 资源预加载

```javascript
// 预加载常用预览器
function preloadPreviewers() {
  const previewers = ['ExcelPreviewer', 'PDFPreviewer', 'ImagePreviewer'];
  previewers.forEach(previewer => {
    import(`./previewers/${previewer}`);
  });
}
```

---

## 10. 组件使用说明

### 10.1 核心组件组合

#### 10.1.1 完整预览页面

```typescript
// 文件预览页面完整示例
import { NavBar } from './components/NavBar';
import { PreviewContainer } from './components/PreviewContainer';
import { Toolbar } from './components/Toolbar';
import { FilePreviewer } from './components/FilePreviewer';

const FilePreviewPage = ({ file }) => {
  const [zoom, setZoom] = useState(100);
  const [currentPage, setCurrentPage] = useState(1);
  const [totalPages, setTotalPages] = useState(0);

  return (
    <div className="preview-page">
      {/* 顶部导航栏 */}
      <NavBar
        title={file.name}
        fileInfo={{
          size: file.size,
          type: file.type
        }}
        actions={[
          { icon: 'fullscreen', label: '全屏', onClick: handleFullscreen },
          { icon: 'download', label: '下载', onClick: handleDownload },
          { icon: 'print', label: '打印', onClick: handlePrint }
        ]}
      />

      {/* 主预览区域 */}
      <PreviewContainer
        file={file}
        zoom={zoom}
        currentPage={currentPage}
        onZoomChange={setZoom}
        onPageChange={setCurrentPage}
      >
        <FilePreviewer file={file} />
      </PreviewContainer>

      {/* 底部工具栏 */}
      <Toolbar
        position="bottom"
        zoom={zoom}
        currentPage={currentPage}
        totalPages={totalPages}
        onZoomIn={() => setZoom(prev => Math.min(prev + 10, 200))}
        onZoomOut={() => setZoom(prev => Math.max(prev - 10, 50))}
        onPreviousPage={() => setCurrentPage(prev => Math.max(prev - 1, 1))}
        onNextPage={() => setCurrentPage(prev => Math.min(prev + 1, totalPages))}
        onFullscreen={handleFullscreen}
        onDownload={handleDownload}
        onPrint={handlePrint}
      />
    </div>
  );
};
```

### 10.2 响应式组件使用

#### 10.2.1 移动端适配

```typescript
import { useBreakpoint } from './hooks/useBreakpoint';

const ResponsivePreviewPage = ({ file }) => {
  const breakpoint = useBreakpoint();
  const isMobile = breakpoint < 768;

  return (
    <div className="preview-page">
      <NavBar
        compact={isMobile}
        // 移动端折叠操作按钮
        actions={isMobile ? [] : [
          { icon: 'fullscreen', label: '全屏', onClick: handleFullscreen },
          { icon: 'download', label: '下载', onClick: handleDownload }
        ]}
      />

      <PreviewContainer>
        <FilePreviewer file={file} />
      </PreviewContainer>

      <Toolbar
        position="bottom"
        compact={isMobile}
        // 移动端精简工具栏
        showZoom={!isMobile}
        showPageNav={!isMobile}
      />
    </div>
  );
};
```

---

## 11. 设计交付物清单

### 11.1 设计文档

- ✅ UI设计方案文档（本文件）
- ✅ 交互流程图
- ✅ 组件使用说明

### 11.2 设计资源

- [ ] 界面原型（桌面端）
- [ ] 界面原型（移动端）
- [ ] 交互原型（关键流程）
- [ ] 图标资源（SVG格式）

### 11.3 开发交付

- [ ] 设计变量文件（CSS Variables）
- [ ] 组件样式文件（SCSS）
- [ ] 响应式断点配置
- [ ] 无障碍规范说明

---

## 12. 实施建议

### 12.1 开发优先级

**Phase 1 - 核心界面（Week 1）**
- 主预览容器
- 顶部导航栏
- 底部工具栏
- 加载状态组件

**Phase 2 - 常用格式（Week 2-3）**
- PDF预览界面
- Office预览界面（Word, Excel, PowerPoint）
- 图片预览界面

**Phase 3 - 扩展格式（Week 4-5）**
- 音视频预览界面
- 压缩包预览界面
- 文本文件预览界面

**Phase 4 - 特殊格式（Week 6）**
- 思维导图预览
- 流程图预览
- 其他特殊格式

**Phase 5 - 优化完善（Week 7-8）**
- 响应式适配
- 性能优化
- 无障碍支持
- 用户体验优化

### 12.2 测试建议

#### 12.2.1 兼容性测试

- 浏览器：Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- 设备：桌面端、平板、手机
- 分辨率：1024×768, 1366×768, 1920×1080, 320×568, 375×667

#### 12.2.2 性能测试

- 首屏加载时间：< 3秒
- 文件类型检测时间：< 100ms
- 大文件加载：流畅，不卡顿
- 缩放操作响应时间：< 200ms

#### 12.2.3 用户体验测试

- 任务完成率：≥ 95%
- 满意度评分：≥ 4.5/5
- 错误率：< 5%

### 12.3 迭代计划

**v0.1.0 - MVP版本**
- 核心界面框架
- PDF、Office基础格式预览
- 基础交互功能

**v0.2.0 - 扩展版本**
- 图片、音视频预览
- 响应式适配
- 性能优化

**v0.3.0 - 完整版本**
- 45种格式全部支持
- 无障碍支持
- 用户体验完善

**v1.0.0 - 正式版本**
- 全面测试完成
- 性能优化完成
- 文档完善

---

## 附录

### A. 文件类型图标配色

| 文件类型分类 | 图标颜色 | 十六进制值 |
|-------------|---------|-----------|
| Office文档类 | 红色 | #D04424 |
| PDF类 | 深红色 | #F40F02 |
| 文档类 | 蓝色 | #2D56B1 |
| 图片类 | 绿色 | #10B981 |
| 音视频类 | 紫色 | #8B5CF6 |
| 压缩包类 | 橙色 | #F59E0B |
| 其他类 | 灰色 | #6B7280 |

### B. 快捷键一览表

| 快捷键 | 功能 |
|-------|------|
| Ctrl/Cmd + + | 放大 |
| Ctrl/Cmd + - | 缩小 |
| Ctrl/Cmd + 0 | 恢复默认缩放 |
| Ctrl/Cmd + F | 全屏 |
| Ctrl/Cmd + P | 打印 |
| Ctrl/Cmd + S | 下载 |
| Ctrl/Cmd + ← | 上一页 |
| Ctrl/Cmd + → | 下一页 |
| Home | 首页 |
| End | 尾页 |
| Esc | 退出全屏/关闭弹窗 |

### C. 参考资料

- PRD文档：docs/PRD.md
- UI设计文档：docs/UI设计文档.md
- 组件规范文档：docs/组件规范文档.md

---

**文档版本**: 1.0  
**编写日期**: 2024  
**设计师**: 文件预览系统UX设计师  
**审核状态**: 待审核
