# 内容工具 (content/)

## 概述

内容工具提供内容适配和能力路由功能，负责将不支持的内容类型转换为文本描述，并根据模型能力决定如何处理消息内容。

## 模块列表

### content_adapter.js
- **职责**：内容适配器
- **功能**：
  - 将不支持的内容类型（图片、音频、文件）转换为文本描述
  - 查找具备相应能力的智能体
  - 提供内容类型到能力类型的映射
  - 格式化文件大小为人类可读格式
- **导出**：
  - `ContentAdapter` 类
  - `formatFileSize` 函数
  - `CONTENT_TYPE_TO_CAPABILITY` 常量
  - `CONTENT_TYPE_LABELS` 常量

### capability_router.js
- **职责**：能力路由器
- **功能**：
  - 根据模型能力决定如何处理消息内容
  - 支持的内容类型直接传递给 LLM
  - 不支持的内容转换为文本描述
  - 处理多模态内容（图片、文件等）
  - 检查服务是否支持处理消息中的所有内容
- **导出**：
  - `CapabilityRouter` 类

## 依赖关系

- `content_adapter.js` 依赖：
  - `../logger/logger.js` - 日志记录
- `capability_router.js` 依赖：
  - `../message/message_formatter.js` - 消息格式化
  - `content_adapter.js` - 内容适配（可选）

## 使用场景

1. **内容适配**：当智能体收到不支持的内容类型时，使用 ContentAdapter 将其转换为文本描述
2. **能力路由**：在发送消息给 LLM 之前，使用 CapabilityRouter 根据模型能力处理消息内容
3. **多模态处理**：处理包含图片、文件等附件的消息

## 注意事项

- 内容适配应该提供清晰的文本描述，让智能体可以理解并决定是否转发
- 能力路由应该根据服务的实际能力进行路由，避免发送不支持的内容
- 文件内容读取应该有大小限制，避免内存溢出
- 二进制文件应该提示需要专门的智能体处理
